- content_for :title, @show.name + @show_years
.page
  .row

    .show-info.large-9.medium-8.columns
      .row
        .large-4.columns
          .show-avatar= image_tag @show.photo_orig
          %button.tiny.button.dropdown.show-status{'data-dropdown' => 'drop1', 'aria-controls' => 'drop1', 'aria-expanded' => 'false'}
            - unless @current_fav.blank?
              - case @current_fav.show_status
                - when 'dont_watch'
                  = I18n.t 'user.dont-watch'
                - when 'watching'
                  = I18n.t 'user.watching'
                - when 'will_watch'
                  = I18n.t 'user.will-watch'
                - when 'stopped_watch'
                  = I18n.t 'user.stopped-watch'
            - else
              = I18n.t 'user.dont-watch'
          %br
          %ul.f-dropdown#drop1{'aria-hidden'=>'true', 'tabindex'=>'-1'}
            %li= link_to (I18n.t 'user.dont-watch'), change_status_path(id: @show.id, status: 'dont_watch')
            %li= link_to (I18n.t 'user.will-watch'), change_status_path(id: @show.id, status: 'will_watch')
            %li= link_to (I18n.t 'user.watching'), change_status_path(id: @show.id, status: 'watching')
            %li= link_to (I18n.t 'user.stopped-watch'), change_status_path(id: @show.id, status: 'stopped_watch')
        .large-8.columns
          .favorite-button
            .switch.tiny
              - unless @current_fav.blank?
                - if @current_fav.favorite == true
                  %input#switch{:type => 'checkbox', :checked => 'true'}
                - else
                  %input#switch{:type => 'checkbox', :checked => 'false'}
              %label{:for=>'switch'}
              %br
              = I18n.t 'show.add-to-favorite'

          %b= (I18n.t 'show.status') + ':'
          - if @show.status == 'Run'
            %span.success.label.radius= @show.status
          - else
            %span.alert.label.radius= @show.status
          %br
          %b= (I18n.t 'show.start-date') + ':'
          = @show.start_date.strftime('%d.%m.%Y')
          %br
          %b= (I18n.t 'show.finish-date') + ':'
          - if @show.finish_date.nil?
            = '...'
          - else
            = @show.finish_date.strftime('%d.%m.%Y')
          %br
          %b= (I18n.t 'show.genres') + ':'
          - @show_genres.each do |genre|
            = link_to genre.name, genre
          %br
          %b= (I18n.t 'show.seasons') + ':'
          = @show.seasons_count
          %br
          %b= (I18n.t 'show.runtime') + ':'
          = @show.runtime.to_s + ' min.'
          %br
          %b= (I18n.t 'show.rate-imdb') + ':'
          - if @show.rate_imdb == nil
            = 'Not rated yet'
          - else
            = @show.rate_imdb
          %br
          %b= 'Загальна оцінка:'
          = rating_for @show, 'rate'
          %b= 'Ваша оцінка:'
          = rating_for_user @show, current_user, 'rate', :star => 7
          %b= (I18n.t 'show.about') + ':'
          = @show.about
          %br


      %ul.seasons
        - count = @show.episodes.last.season
        - i = 0
        - while count > i do
          - current_season = @show_episodes.where(:season => count)
          %li.closeable.close
            %h6= (I18n.t 'show.season') + ' ' + count.to_s
            %table
              %tr
                %th{width: '50px'}= '#'
                %th{width: '530px'}= I18n.t 'show.name'
                %th{width: '50px'}= I18n.t 'show.date'
              - current_season.each do |episode|
                %tr
                  %td= episode.season.to_s + 'x' + episode.number.to_s
                  %td= link_to episode.name, episode
                  - if episode.released <= DateTime.now
                    %td
                      %span.success.label.radius= episode.released.strftime('%d.%m.%Y')
                  - else
                    %td
                      %span.secondary.label.radius= episode.released.strftime('%d.%m.%Y')
          - count -= 1

      %p= link_to (I18n.t 'comment.add'), new_show_comment_path(@show)

      %ul.comment_list
        = render :partial => 'comments/comment', :collection => @show.comments

    .recommendation.large-3.medium-4.small-12.columns
      %h6= I18n.t 'show.recommend'
      - @recommendation.each do |item|
        - if @show != item
          = link_to (image_tag item.photo), item
          = link_to item.name, item
